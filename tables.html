<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
	<title>Hot Restaurant Home</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

</head>

<body>
    <div class="container">
	<div class="jumbotron">

		<h1 class="text-center">
            <span class= "glyphicon glyphicon-fire"></span>
            Hot Restaurant</h1>
        <hr>
        <h2 class="text-center"> </h2>
        <br>
        <div class="text=center">
            <a href="/tables">
            <button type="button" class="btn btn-lg btn-primary">
                <span class="glyphicon glyphicon-list-alt"></span>
            </button>
            </a>
            <a href="/reserve">
            <button type="button" class="btn btn-lg btn-danger">
                <span class="glyphicon glyphicon-credit-card">
                </span>
            </button>
            </a>
        </div>
	</div>
    <div class="row">
        <div class="col-lg-12">
            <!--In Use Table -->
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h4 class="panel-title"> Current Reservations</h4>
                </div>
            <div class="panel-body" id="tableSection">
                <div class="well" id="tableWell-01">
                    <h2>
                        <span class="label label-primary">1</span>
                        |
                    </h2>
                </div>
            <div class="well" id="tableWell-11">
                    <h2>
                        <span class="label label-primary">2</span>
                        |
                    </h2>
                </div>
            <div class="well" id="tableWell-21">
                    <h2>
                        <span class="label label-primary">3</span>
                        |
                    </h2>
                </div>
            </div>
        </div>
        <!--Waiting List -->
            <div class "panel panel-default">
                <div class="panel-heading">
                    <h4 class+"panel-title">Waiting List</h4>
                </div>
            <div class="panel-body" id="waitlistSection">
            <div>
        </div>
    </div>
    </div>

    <footer class="footer"> 
        <div class="container">
            <p>Control Panel</p>
            <p>
            <a href="#" id="clear">Clear Table</a>
            |
            <a href="/api/tables">API Table Link</a>
            |
            <a href="/api/waitlist">API Wait List</a>
            </p>
        </div>
    </footer>

    <!--JQUERY & AJAX Stuff -->
    <script type="text/javascript">
        function runTableQuery(){
            var currentURL = windon.location.origin;
            //AJAX
            $.ajax({url: currentURL + "/api/tables", method: "GET"})
                .done(function(tableData) {
                    console.log("--------------------------------");
                    console.log("URL: " + currentURL + "/api/tables");
                    console.log("--------------------------------");
                    console.log(tableData);
                    console.log("--------------------------------");

                    for (var i=0; i<tableData.length; i++){
                        var tableSection = $("<div>");
                        tableSection.addClass('well');
                        tableSection.attr('id', 'tableWell-' + i+1)
                        $('#tableSection').append(tableSection);

                        var tableNumber = i + 1;
                        
                        $("#tableWell-" + i+1).append('<h2><span class="label label-primary">' + tableNumber + "</span> | " + tableData[i].customerID + "</h2>");

                    }
                });
        }
            function runWaitListQuery() {
                var currentUrl = window.location.origin;
                $.ajax({url: currentUrl + "api/waitlist", method: "GET"})
                    .done(function(waitlistData) {
                    console.log("--------------------------------");
                    console.log("URL: " + currentURL + "/api/waitlist");
                    console.log("--------------------------------");
                    console.log(waitListData);
                    console.log("--------------------------------");

                        for (var i=0; i<waitListData.length; i++){
                        var waitListSection = $("<div>");
                        waitListSection.addClass('well');
                        waitListSection.attr('id', 'tableWell-' + i+1)
                        $('#waitListSection').append(tableSection);

                        var tableNumber = i + 1;
                        
                        $("#waitListWell-" + i+1).append('<h2><span class="label label-primary">' + tableNumber + "</span> | " + waitListData[i].customerID + "</h2>");
                        }
                        
                    });
            }

                function clearTable() {
                    var currentURL = window.location.origin;
                    $.ajax({url: currentURL + "/api/clear", method: "POST"})
                }

                    $("#clear").on('click', function(){
                        alert("Clearing...");
                        clearTable();
                        location.reload();
                    })
                    runTableQuery();
                    runWaitListQuery();
        </script>
	
    </div>
	
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</body>
</html>